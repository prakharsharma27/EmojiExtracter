<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Index</title>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

</head>
<body id="bodyid" onload="trainTest()">
<!--<nav class="navbar navbar-expand-lg navbar-light bg-light">-->
<!--  <div class="container-fluid">-->
<!--    <a class="navbar-brand" href="#">Navbar</a>-->
<!--    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">-->
<!--      <span class="navbar-toggler-icon"></span>-->
<!--    </button>-->
<!--    <div class="collapse navbar-collapse" id="navbarNav">-->
<!--      <ul class="navbar-nav">-->
<!--        <li class="nav-item">-->
<!--          <a class="nav-link active" aria-current="page" href="#">Home</a>-->
<!--        </li>-->
<!--        <li class="nav-item">-->
<!--          <a class="nav-link" href="#">Features</a>-->
<!--        </li>-->
<!--        <li class="nav-item">-->
<!--          <a class="nav-link" href="#">Pricing</a>-->
<!--        </li>-->
<!--        <li class="nav-item">-->
<!--          <a class="nav-link disabled">Disabled</a>-->
<!--        </li>-->
<!--      </ul>-->
<!--    </div>-->
<!--  </div>-->
<!--</nav>-->

<div style="margin:auto;margin-top:10%;width:50%">
<form action="/models" method="get">
    <h4>Its a chat box that gives Emoji by analysing your text. USing ML</h4>
    <textarea id="text" name="chatinput"></textarea>

</form>
<div class="col-6" id="replaceable-content">
    <!--    <h2>{{retype}}</h2>-->
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossOrigin="anonymous"></script>
<script>


    const givenText = document.getElementById('text')
    const changable = document.getElementById('replaceable-content')
    var strHappy = ["&#128532", "&#128512", "&#128514", "&#128517"]
    var strSad = ["&#128522", "&#128545", "&#128546"]
    var counter = 0;
    const printAgainkarega = (val) => {
        $.ajax({
            type: 'GET',
            url: 'textShow/',
            data: {
                'val': val
            },
            dataType: 'json',
            success: function (data) {

                var str = []
                if (counter > 0) {

                    removeChildren('emojibtn0')

                    counter = 0
                }
                var temp = `${(JSON.stringify(data['retype']))}`
                temp = temp.substring(1, temp.length - 1)
                str.push(temp)

                if (str[0] == "&#128522") {
                    for (var x = 0; x < strHappy.length; x++) {
                        str.push(strHappy[x])
                    }
                } else {
                    for (var x = 0; x < strSad.length; x++) {
                        str.push(strSad[x])
                    }
                }
                var buttonsWanted = str.length


                for (var x = 0; x < buttonsWanted; x++) {

                    counter++;
                    var button = document.createElement('button')

                    button.setAttribute('id', 'emojibtn' + x)
                    button.setAttribute('onclick', 'addEmoji(emojibtn' + x + ')')
                    // alert("mid")
                    // docFrag.appendChild(button);
                    changable.appendChild(button)
                    document.getElementById('emojibtn' + x).innerHTML = str[x]

                }

            },
            error: function (error) {
                console.log(error)
            }
        })
    }
    givenText.addEventListener("keyup", e => {

        printAgainkarega(e.target.value)
    })


    function trainTest() {

        $.ajax({
            type: 'GET',
            url: 'models/',
            success: function (data) {

                console.log = `${JSON.stringify(data)}`
            },
            error: function (error) {
                console.log(error)
            }
        })
    }

    function addEmoji(ele) {

        var id = ele.id

        givenText.value += document.getElementById(id).innerHTML
    }

    function removeChildren(params) {
        var ele = document.getElementById(params)
        var parentId = ele.parentNode.id;

        var childNodes = document.getElementById(parentId).childNodes;
        for (var i = childNodes.length - 1; i >= 0; i--) {
            var childNode = childNodes[i];

            childNode.parentNode.removeChild(childNode);

        }
    }
</script>
</body>

</html>